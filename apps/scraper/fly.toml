# Fly.io Machine configuration for mirapuri crawler
#
# Build image (from repo root):
#   flyctl deploy --build-only --push --app mirapuri-stats --dockerfile apps/scraper/Dockerfile
#
# Run machine (from repo root):
#   fly machine run . --app mirapuri-stats --dockerfile apps/scraper/Dockerfile [-- <args>]
#
# Examples:
#   fly machine run . --app mirapuri-stats --dockerfile apps/scraper/Dockerfile
#   fly machine run . --app mirapuri-stats --dockerfile apps/scraper/Dockerfile -- --dc Gaia

app = "mirapuri-stats"
primary_region = "nrt"  # Tokyo

# Machine resources
# shared-cpu-1x is enough for crawler (it's I/O bound, not CPU bound)
[[vm]]
  size = "shared-cpu-1x"
  memory = "256mb"

[env]
  NODE_ENV = "production"
  # DATABASE_URL should be set via secrets:
  #   fly secrets set DATABASE_URL=postgres://...

# No HTTP services - this is a batch job
# [[services]]
