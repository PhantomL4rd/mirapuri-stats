# Fly.io Machine configuration for mirapuri crawler
#
# Usage:
#   fly machine run . --config fly.toml [-- <args>]
#
# Examples:
#   fly machine run . --config fly.toml                        # Tiamat (default)
#   fly machine run . --config fly.toml -- --world Bahamut     # Single world
#   fly machine run . --config fly.toml -- --dc Gaia           # Full DC (8 worlds)

app = "mirapuri-stats"
primary_region = "nrt"  # Tokyo

[build]
  dockerfile = "apps/scraper/Dockerfile"

# Machine resources
# shared-cpu-1x is enough for crawler (it's I/O bound, not CPU bound)
[[vm]]
  size = "shared-cpu-1x"
  memory = "256mb"

[env]
  NODE_ENV = "production"
  # DATABASE_URL should be set via secrets:
  #   fly secrets set DATABASE_URL=postgres://...

# No HTTP services - this is a batch job
# [[services]]
